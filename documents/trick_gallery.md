# Tricks, corresponding results, experimental settings, and running commands

- The file contains the results, experimental settings, and running commands of different tricks. These tricks are divided into four families, which are re-weighting, re-sampling, mixup training, and two-stage training. For more details of the above four trick families, see the [original paper](https://cs.nju.edu.cn/wujx/paper/AAAI2021_Tricks.pdf).
- For any problem, such as bugs, feel free to [open an issue](https://github.com/zhangyongshun/BagofTricks-LT/issues).
- <u>Before you train, you should change the training and validation jsons in CONFIG files to your own path.</u>
- <u>Click each method to get the experimental setting  configs and running commands.</u>

### Re-weighting

- Strictly speaking, the LDAM loss, CrossEntropyLabelSmooth, CDT, and SEQL do not belong to re-weighting methods, but both of them consider the long-tailed distribution when calculate the losses, and they can be combined with re-weighting in DRW. So we add them to re-weighting family.

| Datasets                                                     | CIFAR-10-LT-100 | CIFAR-10-LT-50 | CIFAR-100-LT-100 | CIFAR-100-LT-50 |
| ------------------------------------------------------------ | :-------------: | :------------: | :--------------: | :-------------: |
| <details><summary>Baseline</summary> <ol><li>CONFIG (from left to right):<ul>          <li>configs/cui_cifar/baseline/{cifar10_im100.yaml, cifar10_im50.yaml, cifar100_im100.yaml, cifar100_im50.yaml}</li></ul>      </li><br/>      <li>Running commands:<ul><li>bash data_parallel_train.sh CONFIG GPU</li></ul> </li>      </ol></details> |      30.12      |     24.81      |      61.76       |      57.65      |
| <details><summary>CE_CE</summary> <ol><li>Introduction: <ul><li>The most commonly used re-weighting method, you can see Eq. (2) in our [paper]() for more details. </li></ul></li> <br/> <li>CONFIG:<ul><li>configs/cui_cifar/loss/csce/{cifar10_im100.yaml, cifar10_im50.yaml, cifar100_im100.yaml, cifar100_im50.yaml}</li></ul>  </li><br/>      <li>Running commands:<ul><li>bash data_parallel_train.sh CONFIG GPU</li></ul> </li>      </ol></details> |      31.22      |     22.06      |      69.41       |      62.05      |
| <details><summary>Square CS_CE</summary> <ol><li>Introduction: <ul><li>This is a smooth version of CE_CE (smooth CS_CE), which add a hyper-parameter $ \gamma$ to vanilla CS_CE. In smooth CS_CE, the loss weight of class i is defined as: $(\frac{N_{min}}{N_i})^\gamma$, where $\gamma \in [0, 1]$, $N_i$ is the number of images in class i. We set $\gamma = 0.5$ to get a square-root version of CS_CE (Square CE_CE). </li></ul></li> <br/> <li>CONFIG:<ul><li>configs/cui_cifar/loss/csce/{cifar10_im100_square.yaml, cifar10_im50_square.yaml, cifar100_im100_square.yaml, cifar100_im50_square.yaml}</li></ul>      </li><br/>      <li>Running commands:<ul><li>bash data_parallel_train.sh CONFIG GPU</li></ul> </li>      </ol></details> |      31.58      |     22.78      |      62.01       |      57.66      |
| <details><summary>Focal loss</summary> <ol><li>Introduction: <ul><li>Focal loss makes the model focus training on difficult samples, and you can see Eq. (4) in our [paper]() for more details.</li><li>The Focal loss paper link: [Lin et al., ICCV 2017](https://arxiv.org/abs/1708.02002).</li></ul></li> <br/> <li>CONFIG:<ul><li>configs/cui_cifar/loss/focal/{cifar10_im100.yaml, cifar10_im50.yaml, cifar100_im100.yaml, cifar100_im50.yaml}</li></ul>      </li><br/>      <li>Running commands:<ul><li>bash data_parallel_train.sh CONFIG GPU</li></ul> </li>      </ol></details> |      30.88      |     24.12      |      62.59       |      59.46      |
| <details><summary>ClassBalanceFocal</summary><ol><li>Introduction: <ul><li>The modified version of Focal loss, which is based on the theory of effective numbers, and you can see Eq. (5) in our [paper]() for more details.</li><li>The ClassBalanceFocal paper link: [Cui et al., CVPR 2019](https://arxiv.org/abs/1901.05555).</li></ul></li> <br/> <li>CONFIG:<ul><li>configs/cui_cifar/loss/cbfocal/{cifar10_im100.yaml, cifar10_im50.yaml, cifar100_im100.yaml, cifar100_im50.yaml}</li></ul>      </li><br/>      <li>Running commands:<ul><li>bash data_parallel_train.sh CONFIG GPU</li></ul> </li>      </ol></details> |      26.83      |     21.71      |      62.11       |      57.70      |
| <details><summary>ClassBalanceCE</summary><ol><li>Introduction: <ul><li>The modified version of cross-entropy loss, which is based on the theory of effective numbers, and you can see Eq. (6) in our [paper]() for more details.</li><li>The ClassBalanceCE paper link: [Cui et al., CVPR 2019](https://arxiv.org/abs/1901.05555).</li></ul></li> <br/> <li>CONFIG:<ul><li>configs/cui_cifar/loss/cbce/{cifar10_im100.yaml, cifar10_im50.yaml, cifar100_im100.yaml, cifar100_im50.yaml}</li></ul>      </li><br/>      <li>Running commands:<ul><li>bash data_parallel_train.sh CONFIG GPU</li></ul> </li>      </ol></details> |      29.80      |     22.91      |      61.50       |      57.98      |
| <details><summary>CrossEntropyLabelSmooth</summary><ol><li>Introduction: <ul><li>The commonly used regularization trick, label smoothing,  based on cross-entropy loss. </li><li>The CrossEntropyLabelSmooth paper link: [Szegedy et al., CVPR 2016](https://arxiv.org/abs/1512.00567).</li></ul></li> <br/> <li>CONFIG:<ul><li>configs/cui_cifar/loss/cels/{cifar10_im100.yaml, cifar10_im50.yaml, cifar100_im100.yaml, cifar100_im50.yaml}</li></ul>      </li><br/>      <li>Running commands:<ul><li>bash data_parallel_train.sh CONFIG GPU</li></ul> </li>      </ol></details> |      30.44      |     24.35      |      62.80       |      57.55      |
| <details><summary>CrossEntropyLabelAwareSmooth</summary><ol><li>Introduction: <ul><li>The  modified regularization trick, label-aware smoothing,  which is based on label smoothing. It assigns different smoothing factors for each class according to the number of training images it contains. </li><li>The CrossEntropyLabelAwareSmooth paper link: [Zhong et al., CVPR 2021](https://arxiv.org/abs/2104.00466).</li></ul></li> <br/> <li>CONFIG:<ul><li>configs/cui_cifar/loss/celas/{cifar10_im100.yaml, cifar10_im50.yaml, cifar100_im100.yaml, cifar100_im50.yaml}</li></ul>      </li><br/>      <li>Running commands:<ul><li>bash data_parallel_train.sh CONFIG GPU</li></ul> </li>      </ol></details> |      30.88      |     24.33      |      62.96       |      58.29      |
| <details><summary>LDAM loss</summary><ol><li>Introduction: <ul><li>LDAM loss is one of metric learning methods, which aims to assign different margins to different class. </li><li>The LDAM loss paper link: [Cao et al., NeurIPS 2019](https://arxiv.org/abs/1906.07413).</li></ul></li> <br/> <li>CONFIG:<ul><li>configs/cui_cifar/loss/ldam/{cifar10_im100.yaml, cifar10_im50.yaml, cifar100_im100.yaml, cifar100_im50.yaml}</li></ul>      </li><br/>      <li>Running commands:<ul><li>bash data_parallel_train.sh CONFIG GPU</li></ul> </li>      </ol></details> |      29.37      |     23.15      |      61.24       |      57.86      |
| <details><summary>SEQL</summary><ol><li>**The SEQL in my implementation doesn't work. The loss will be NaN in training procedure. I will figure out this bug in next few days.**</li><br/><li>Introduction: <ul><li>The softmax equalization loss (SEQL) aims to reduce the gradients of tail classes' negative samples. The author argues that the imbalance of gradients in tail classes' positive and negtive samples causes bad influences.</li><li>The SEQL paper link: [Tan et al., CVPR 2020](https://arxiv.org/abs/2003.05176).</li></ul></li> <br/> <li>CONFIG:<ul><li>configs/cui_cifar/loss/seql/{cifar10_im100.yaml, cifar10_im50.yaml, cifar100_im100.yaml, cifar100_im50.yaml}</li></ul>      </li><br/>      <li>Running commands:<ul><li>bash data_parallel_train.sh CONFIG GPU</li></ul> </li>      </ol></details> |       --        |       --       |        --        |       --        |
| <details><summary>CDT</summary><ol><li>Introduction: <ul><li>The authors find that a model significantly over-fits the tail classes, and they argue that feature deviation between the training and test samples causes this problem. So they propose class-dependent temperatures (CDT). </li><li>The CDT paper link: [Ye et al., arXiv 2020](https://arxiv.org/abs/2001.01385).</li></ul></li> <br/> <li>CONFIG:<ul><li>configs/cui_cifar/loss/cdt/{cifar10_im100.yaml, cifar10_im50.yaml, cifar100_im100.yaml, cifar100_im50.yaml}</li></ul>      </li><br/>      <li>Running commands:<ul><li>bash data_parallel_train.sh CONFIG GPU</li></ul> </li>      </ol></details> |      25.08      |   **19.89**    |      59.90       |      56.33      |
| <details><summary>BalancedSoftmaxCE</summary><ol><li>Introduction: <ul><li>A simple and effective re-weighting method, and you can see Eq. (4) in the author paper. </li><li>The BalancedSoftmaxCE paper link: [Ren et al., NeurIPS 2020](https://arxiv.org/abs/2007.10740).</li></ul></li> <br/> <li>CONFIG:<ul><li>configs/cui_cifar/loss/bsce/{cifar10_im100.yaml, cifar10_im50.yaml, cifar100_im100.yaml, cifar100_im50.yaml}</li></ul>      </li><br/>      <li>Running commands:<ul><li>bash data_parallel_train.sh CONFIG GPU</li></ul> </li>      </ol></details> |    **23.63**    |     20.07      |    **56.82**     |    **54.55**    |

### Re-sampling

| Datasets                                                     | CIFAR-10-LT-100 | CIFAR-10-LT-50 | CIFAR-100-LT-100 | CIFAR-100-LT-50 |
| ------------------------------------------------------------ | :-------------: | :------------: | :--------------: | :-------------: |
| <details><summary>Baseline</summary> <ol><li>CONFIG (from left to right):<ul>          <li>configs/cui_cifar/baseline/{cifar10_im100.yaml, cifar10_im50.yaml, cifar100_im100.yaml, cifar100_im50.yaml}</li></ul>      </li><br/>      <li>Running commands:<ul><li>bash data_parallel_train.sh CONFIG GPU</li></ul> </li>      </ol></details> |      30.12      |     24.81      |      61.76       |      57.65      |
| <details><summary>Class-balanced sampling</summary><ol><li>Introduction: <ul><li>Class-balanced sampling makes each class to have an equal probability of being selected, and you can see the section `Re-sampling` in our [paper]() for more details. </li><li>The class-balanced sampling paper link: [Kang et al., ICLR 2020](https://arxiv.org/abs/1910.09217).</li></ul></li> <br/> <li>CONFIG:<ul><li>configs/cui_cifar/resampling/balance/{cifar10_im100.yaml, cifar10_im50.yaml, cifar100_im100.yaml, cifar100_im50.yaml}</li></ul>      </li><br/>      <li>Running commands:<ul><li>bash data_parallel_train.sh CONFIG GPU</li></ul> </li>      </ol></details> |      30.35      |   **23.38**    |      66.47       |      61.07      |
| <details><summary>Square-root sampling</summary><ol><li>Introduction: <ul><li>Square-root sampling aims to return a lighter imbalanced dataset., and you can see the section `Re-sampling` in our [paper]() for more details. </li><li>The square-root sampling paper link: [Kang et al., ICLR 2020](https://arxiv.org/abs/1910.09217).</li></ul></li> <br/> <li>CONFIG:<ul><li>configs/cui_cifar/resampling/square/{cifar10_im100.yaml, cifar10_im50.yaml, cifar100_im100.yaml, cifar100_im50.yaml}</li></ul>      </li><br/>      <li>Running commands:<ul><li>bash data_parallel_train.sh CONFIG GPU</li></ul> </li>      </ol></details> |      30.81      |     23.61      |      64.67       |      58.03      |
| <details><summary>Progressively-balanced sampling</summary><ol><li>Introduction: <ul><li>Progressively-balanced sampling changes the sampling probabilities of classes from random sampling to class-balanced sampling., and you can see the section `Re-sampling` in our [paper]() for more details. </li><li>The progressively-balanced sampling paper link: [Kang et al., ICLR 2020](https://arxiv.org/abs/1910.09217).</li></ul></li> <br/> <li>CONFIG:<ul><li>configs/cui_cifar/resampling/progressive/{cifar10_im100.yaml, cifar10_im50.yaml, cifar100_im100.yaml, cifar100_im50.yaml}</li></ul>      </li><br/>      <li>Running commands:<ul><li>bash data_parallel_train.sh CONFIG GPU</li></ul> </li>      </ol></details> |    **29.35**    |     24.06      |    **60.90**     |    **56.92**    |

### Mixup training

| Datasets                                                     | CIFAR-10-LT-100 | CIFAR-10-LT-50 | CIFAR-100-LT-100 | CIFAR-100-LT-50 |
| ------------------------------------------------------------ | :-------------: | :------------: | :--------------: | :-------------: |
| <details><summary>Baseline</summary> <ol><li>CONFIG (from left to right):<ul>          <li>configs/cui_cifar/baseline/{cifar10_im100.yaml, cifar10_im50.yaml, cifar100_im100.yaml, cifar100_im50.yaml}</li></ul>      </li><br/>      <li>Running commands:<ul><li>bash data_parallel_train.sh CONFIG GPU</li></ul> </li>      </ol></details> |      30.12      |     24.81      |      61.76       |      57.65      |
| <details><summary>Baseline (400 epochs)</summary><ol><li>Using baseline settings to train 400 epochs. On CIFAR-LT, the learning rate should be divided by 100 at the 320th and 360th epoch, respectively.</li></ol></details> |      29.71      |     23.50      |      60.92       |      56.59      |
| <details><summary>Input mixup</summary> <ol><li>Introduction: <ul><li>In input mixup, each new example is formed with two randomly sampled example by a weighted linear interpolation, and we only use the new example to train the network. You can see the section `Mixup training` in our [paper]() for more details. </li><li>The mixup paper link: [Zhang et al., ICLR 2018](https://arxiv.org/abs/1710.09412).</li></ul></li> <br/> <li>CONFIG:<ul><li>configs/cui_cifar/mixup/input_mixup/{cifar10_im100_im_alpha10.yaml, cifar10_im50_im_alpha10.yaml, cifar100_im100_im_alpha10.yaml, cifar100_im50_im_alpha10.yaml}</li></ul>      </li><br/>      <li>Running commands:<ul><li>bash data_parallel_train.sh CONFIG GPU</li></ul> </li>      </ol></details> |      28.55      |     21.83      |      60.10       |      55.25      |
| <details><summary>Manifold mixup</summary><ol><li>Introduction: <ul><li>Manifold mixup encourages neural networks to predict less confidently on interpolations of hidden representations. We apply manifold mixup on only one layer in our experiments. You can see the section `Mixup training` in our [paper]() for more details. </li><li>The manifold mixup paper link: [Verma et al., ICML 2019](https://arxiv.org/abs/1806.05236).</li></ul></li> <br/> <li>CONFIG:<ul><li>configs/cui_cifar/mixup/manifold_mixup/{cifar10_im100_mm_alpha10.yaml, cifar10_im50_mm_alpha10.yaml, cifar100_im100_mm_alpha10.yaml, cifar100_im50_mm_alpha10.yaml}</li></ul>      </li><br/>      <li>Running commands:<ul><li>bash data_parallel_train.sh CONFIG GPU</li></ul> </li>      </ol></details> |    **27.88**    |   **21.68**    |      60.53       |      56.76      |
| <details><summary>Remix</summary><ol><li>Introduction: <ul><li>Remix assigns the label in favor of the minority class by providing a disproportionately higher weight to the minority class. </li><li>The remix paper link: [Chou et al., ECCV 2020 workshop](https://arxiv.org/abs/1710.09412).</li></ul></li> <br/> <li>CONFIG:<ul><li>configs/cui_cifar/mixup/remix/{cifar10_im100_remix_alpha10.yaml, cifar10_im50_remix_alpha10.yaml, cifar100_remix100_im_alpha10.yaml, cifar100_im50_remix_alpha10.yaml}</li></ul>      </li><br/>      <li>Running commands:<ul><li>bash data_parallel_train.sh CONFIG GPU</li></ul> </li>      </ol></details> |      29.50      |     23.44      |    **59.13**     |    **54.62**    |

### Two-stage training

##### DRW

| First Stage | Second Stage                                                 | CIFAR-10-LT-100 | CIFAR-10-LT-50 | CIFAR-100-LT-100 | CIFAR-100-LT-50 |
| ----------- | :----------------------------------------------------------- | :-------------: | :------------: | :--------------: | :-------------: |
| CE          | <details><summary>CE</summary> <ol><li>CONFIG (from left to right):<ul>          <li>configs/cui_cifar/baseline/{cifar10_im100.yaml, cifar10_im50.yaml, cifar100_im100.yaml, cifar100_im50.yaml}</li></ul>      </li><br/>      <li>Running commands:<ul><li>bash data_parallel_train.sh CONFIG GPU</li></ul> </li>      </ol></details> |      30.12      |     24.81      |      61.76       |      57.65      |
| CE          | <details><summary>CE_CE</summary> <ol> <li>CONFIG:<ul><li>configs/cui_cifar/two_stage/drw/csce/{cifar10_im100.yaml, cifar10_im50.yaml, cifar100_im100.yaml, cifar100_im50.yaml}</li></ul>  </li><br/>      <li>Running commands:<ul><li>bash data_parallel_train.sh CONFIG GPU</li></ul> </li>      </ol></details> |      26.66      |     20.71      |      59.36       |      54.77      |
| CE          | <details><summary>Square CS_CE</summary> <ol> <li>CONFIG:<ul><li>configs/cui_cifar/two_stage/drw/csce/{cifar10_im100_square.yaml, cifar10_im50_square.yaml, cifar100_im100_square.yaml, cifar100_im50_square.yaml}</li></ul>      </li><br/>      <li>Running commands:<ul><li>bash data_parallel_train.sh CONFIG GPU</li></ul> </li>      </ol></details> |      28.31      |     22.30      |      60.45       |      56.07      |
| CE          | <details><summary>Focal loss</summary> <ol> <li>CONFIG:<ul><li>configs/cui_cifar/two_stage/drw/focal/{cifar10_im100.yaml, cifar10_im50.yaml, cifar100_im100.yaml, cifar100_im50.yaml}</li></ul>      </li><br/>      <li>Running commands:<ul><li>bash data_parallel_train.sh CONFIG GPU</li></ul> </li>      </ol></details> |      27.97      |     22.25      |      62.41       |      58.51      |
| CE          | <details><summary>ClassBalanceFocal</summary><ol> <li>CONFIG:<ul><li>configs/cui_cifar/two_stage/drw/cbfocal/{cifar10_im100.yaml, cifar10_im50.yaml, cifar100_im100.yaml, cifar100_im50.yaml}</li></ul>      </li><br/>      <li>Running commands:<ul><li>bash data_parallel_train.sh CONFIG GPU</li></ul> </li>      </ol></details> |      26.69      |     20.75      |      62.19       |      56.68      |
| CE          | <details><summary>ClassBalanceCE</summary><ol> <li>CONFIG:<ul><li>configs/cui_cifar/two_stage/drw/cbce/{cifar10_im100.yaml, cifar10_im50.yaml, cifar100_im100.yaml, cifar100_im50.yaml}</li></ul>      </li><br/>      <li>Running commands:<ul><li>bash data_parallel_train.sh CONFIG GPU</li></ul> </li>      </ol></details> |      26.87      |     20.94      |      61.57       |      57.49      |
| CE          | <details><summary>CrossEntropyLabelSmooth</summary><ol> <li>CONFIG:<ul><li>configs/cui_cifar/two_stage/drw/cels/{cifar10_im100.yaml, cifar10_im50.yaml, cifar100_im100.yaml, cifar100_im50.yaml}</li></ul>      </li><br/>      <li>Running commands:<ul><li>bash data_parallel_train.sh CONFIG GPU</li></ul> </li>      </ol></details> |      30.44      |     24.35      |      62.80       |      57.55      |
| CE          | <details><summary>LDAM loss</summary><ol> <li>CONFIG:<ul><li>configs/cui_cifar/two_stage/drw/ldam/{cifar10_im100.yaml, cifar10_im50.yaml, cifar100_im100.yaml, cifar100_im50.yaml}</li></ul>      </li><br/>      <li>Running commands:<ul><li>bash data_parallel_train.sh CONFIG GPU</li></ul> </li>      </ol></details> |    **24.61**    |     20.31      |      59.08       |      54.46      |
| CE          | <details><summary>CDT</summary><ol> <li>CONFIG:<ul><li>configs/cui_cifar/two_stage/drw/cdt/{cifar10_im100.yaml, cifar10_im50.yaml, cifar100_im100.yaml, cifar100_im50.yaml}</li></ul>      </li><br/>      <li>Running commands:<ul><li>bash data_parallel_train.sh CONFIG GPU</li></ul> </li>      </ol></details> |      25.15      |   **19.29**    |    **58.38**     |    **53.97**    |
| CE          | <details><summary>BalancedSoftmaxCE</summary><ol> <li>CONFIG:<ul><li>configs/cui_cifar/two_stage/drw/bsce/{cifar10_im100.yaml, cifar10_im50.yaml, cifar100_im100.yaml, cifar100_im50.yaml}</li></ul>      </li><br/>      <li>Running commands:<ul><li>bash data_parallel_train.sh CONFIG GPU</li></ul> </li>      </ol></details> |      25.30      |     19.49      |      58.60       |      54.16      |

##### DRS

| First Stage | Second Stage                                                 | CIFAR-10-LT-100 | CIFAR-10-LT-50 | CIFAR-100-LT-100 | CIFAR-100-LT-50 |
| ----------- | :----------------------------------------------------------- | :-------------: | :------------: | :--------------: | :-------------: |
| CE          | <details><summary>Vanilla sampling</summary> <ol><li>CONFIG (from left to right):<ul>          <li>configs/cui_cifar/baseline/{cifar10_im100.yaml, cifar10_im50.yaml, cifar100_im100.yaml, cifar100_im50.yaml}</li></ul>      </li><br/>      <li>Running commands:<ul><li>bash data_parallel_train.sh CONFIG GPU</li></ul> </li>      </ol></details> |      30.12      |     24.81      |      61.76       |      57.65      |
| CE          | <details><summary>Square-root sampling</summary> <ol> <li>CONFIG:<ul><li>configs/cui_cifar/two_stage/drs/squre/{cifar10_im100.yaml, cifar10_im50.yaml, cifar100_im100.yaml, cifar100_im50.yaml}</li></ul>  </li><br/>      <li>Running commands:<ul><li>bash data_parallel_train.sh CONFIG GPU</li></ul> </li>      </ol></details> |      28.60      |     21.85      |      60.09       |      55.74      |
| CE          | <details><summary>Progressively-balanced sampling</summary> <ol> <li>CONFIG:<ul><li>configs/cui_cifar/two_stage/drs/progressive/{cifar10_im100.yaml, cifar10_im50.yaml, cifar100_im100.yaml, cifar100_im50.yaml}</li></ul>  </li><br/>      <li>Running commands:<ul><li>bash data_parallel_train.sh CONFIG GPU</li></ul> </li>      </ol></details> |      27.73      |     21.82      |      59.20       |      54.60      |
| CE          | <details><summary>Class-balanced sampling</summary> <ol> <li>CONFIG:<ul><li>configs/cui_cifar/two_stage/drs/balance/{cifar10_im100.yaml, cifar10_im50.yaml, cifar100_im100.yaml, cifar100_im50.yaml}</li></ul>  </li><br/>      <li>Running commands:<ul><li>bash data_parallel_train.sh CONFIG GPU</li></ul> </li>      </ol></details> |      27.08      |     21.18      |      58.66       |      54.26      |
| CE          | <details><summary>CAM-based square-sampling</summary> <ol> <li>CONFIG:<ul><li>**FIRST-STAGE-CONFIG:** configs/cui_cifar/two_stage/drs/cam_based_sampling/first_stage/{cifar10_im100.yaml, cifar10_im50.yaml, cifar100_im100.yaml, cifar100_im50.yaml}</li><li>**CAM-GENERATION-CONFIG:** configs/cui_cifar/two_stage/drs/cam_based_sampling/cam_generation/{cifar10_im100.yaml, cifar10_im50.yaml, cifar100_im100.yaml, cifar100_im50.yaml}</li><li> **SECOND-STAGE-CONFIG:** configs/cui_cifar/two_stage/drs/cam_based_sampling/second_stage/square/{cifar10_im100.yaml, cifar10_im50.yaml, cifar100_im100.yaml, cifar100_im50.yaml}</li></ul>  </li><br/>      <li>Running commands:<ul><li>You have three steps. You should run this codebase with the configs in **the first stage**, **CAM generation**, and **the second stage**  step by step.</li><li><ul>bash data_parallel_train.sh FIRST-STAGE-CONFIG GPU</ul><ul>bash data_parallel_train.sh CAM-GENERATION-CONFIG GPU</ul><ul>bash data_parallel_train.sh SECOND-STAGE-CONFIG GPU</ul></li></ul> </li>      </ol></details> |      25.08      |     20.13      |      59.76       |      55.43      |
| CE          | <details><summary>CAM-based progressive-sampling</summary> <ol><li>CONFIG:<ul><li>**FIRST-STAGE-CONFIG:** configs/cui_cifar/two_stage/drs/cam_based_sampling/first_stage/{cifar10_im100.yaml, cifar10_im50.yaml, cifar100_im100.yaml, cifar100_im50.yaml}</li><li>**CAM-GENERATION-CONFIG:** configs/cui_cifar/two_stage/drs/cam_based_sampling/cam_generation/{cifar10_im100.yaml, cifar10_im50.yaml, cifar100_im100.yaml, cifar100_im50.yaml}</li><li> **SECOND-STAGE-CONFIG:** configs/cui_cifar/two_stage/drs/cam_based_sampling/second_stage/progressive/{cifar10_im100.yaml, cifar10_im50.yaml, cifar100_im100.yaml, cifar100_im50.yaml}</li></ul>  </li><br/>      <li>Running commands:<ul><li>You have three steps. You should run this codebase with the configs in **the first stage**, **CAM generation**, and **the second stage**  step by step.</li><li><ul>bash data_parallel_train.sh FIRST-STAGE-CONFIG GPU</ul><ul>bash data_parallel_train.sh CAM-GENERATION-CONFIG GPU</ul><ul>bash data_parallel_train.sh SECOND-STAGE-CONFIG GPU</ul></li></ul> </li>      </ol></details> |      25.56      |     19.96      |      59.18       |      54.79      |
| CE          | <details><summary>CAM-based balance-sampling</summary> <ol> <li>CONFIG:<ul><li>**FIRST-STAGE-CONFIG:** configs/cui_cifar/two_stage/drs/cam_based_sampling/first_stage/{cifar10_im100.yaml, cifar10_im50.yaml, cifar100_im100.yaml, cifar100_im50.yaml}</li><li>**CAM-GENERATION-CONFIG:** configs/cui_cifar/two_stage/drs/cam_based_sampling/cam_generation/{cifar10_im100.yaml, cifar10_im50.yaml, cifar100_im100.yaml, cifar100_im50.yaml}</li><li> **SECOND-STAGE-CONFIG:** configs/cui_cifar/two_stage/drs/cam_based_sampling/second_stage/balance/{cifar10_im100.yaml, cifar10_im50.yaml, cifar100_im100.yaml, cifar100_im50.yaml}</li></ul>  </li><br/>      <li>Running commands:<ul><li>You have three steps. You should run this codebase with the configs in **the first stage**, **CAM generation**, and **the second stage**  step by step.</li><li><ul>bash data_parallel_train.sh FIRST-STAGE-CONFIG GPU</ul><ul>bash data_parallel_train.sh CAM-GENERATION-CONFIG GPU</ul><ul>bash data_parallel_train.sh SECOND-STAGE-CONFIG GPU</ul></li></ul> </li>      </ol></details> |    **23.59**    |   **18.55**    |    **58.38**     |    **53.25**    |

#### Classifier-balancing

Classifier-balancing shows another way to balance the backbone and classifier. Unlike DRS and DRW, it trains a backbone firstly and then freezes the backbone to re-balance the classifier. 

The classifier-balancing methods introduced in [Kang et al., ICLR 2020](https://arxiv.org/abs/1910.09217),  includes tau_normalization, LWS and cRT. You can see the Section 4 in the paper for details of these methods,

| Datasets                                                     | CIFAR-10-LT-100 | CIFAR-10-LT-50 | CIFAR-100-LT-100 | CIFAR-100-LT-50 |
| ------------------------------------------------------------ | :-------------: | :------------: | :--------------: | :-------------: |
| <details><summary>Baseline</summary> <ol><li>CONFIG (from left to right):<ul>          <li>configs/cui_cifar/baseline/{cifar10_im100.yaml, cifar10_im50.yaml, cifar100_im100.yaml, cifar100_im50.yaml}</li></ul>      </li><br/>      <li>Running commands:<ul><li>bash data_parallel_train.sh CONFIG GPU</li></ul> </li>      </ol></details> |      30.12      |     24.81      |      61.76       |      57.65      |
| <details><summary>Tau_normalization</summary><ol><li>Introduction: <ul><li>The tau_normalization paper link: [Kang et al., ICLR 2020](https://arxiv.org/abs/1910.09217).</li><li>**When using tau_normalization, you should have a trained model firstly and then change the `TEST.MODEL_FILE` to your own path.**</li></ul></li> <br/> <li>CONFIG:<ul><li>configs/cui_cifar/two_stage/classifier_balance/tau_norm/{cifar10_im100.yaml, cifar10_im50.yaml, cifar100_im100.yaml, cifar100_im50.yaml}</li></ul>      </li><br/>      <li>Running commands:<ul><li>bash data_parallel_train.sh CONFIG GPU</li></ul> </li>      </ol></details> |    **29.34**    |   **21.90**    |    **58.38**     |    **56.10**    |
| <details><summary>cRT (Classifier Re-training)</summary><ol><li>Introduction: <ul><li>The cRT paper link: [Kang et al., ICLR 2020](https://arxiv.org/abs/1910.09217).</li></ul></li> <br/> <li>CONFIG:<ul><li>configs/cui_cifar/two_stage/classifier_balance/cRT/{cifar10_im100.yaml, cifar10_im50.yaml, cifar100_im100.yaml, cifar100_im50.yaml}</li></ul>      </li><br/>      <li>Running commands:<ul><li>bash data_parallel_train.sh CONFIG GPU</li></ul> </li>      </ol></details> |                 |                |                  |                 |
| <details><summary>LWS (Learnable weight scaling)</summary><ol><li>Introduction: <ul><li>The LWS paper link: [Kang et al., ICLR 2020](https://arxiv.org/abs/1910.09217).</li></ul></li> <br/> <li>CONFIG:<ul><li>configs/cui_cifar/two_stage/classifier_balance/LWS/{cifar10_im100.yaml, cifar10_im50.yaml, cifar100_im100.yaml, cifar100_im50.yaml}</li></ul>      </li><br/>      <li>Running commands:<ul><li>bash data_parallel_train.sh CONFIG GPU</li></ul> </li>      </ol></details> |                 |                |                  |                 |